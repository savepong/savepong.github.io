---
// Blog post page template
import Layout from '@/layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
    const posts = await getCollection('blog');
    return posts.map(post => ({
        params: { slug: post.slug },
        props: { post },
    }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={`${post.data.title} | Pongsiri P.`} description={post.data.description}>
    <article class="min-h-screen pt-24 pb-16 px-6">
        <div class="max-w-3xl mx-auto">
            <a href="/blog" class="inline-flex items-center gap-2 text-sm text-slate-500 hover:text-slate-800 transition-colors mb-8">
                <i class="fas fa-arrow-left"></i>
                Back to Blog
            </a>
            
            <!-- White background container for content -->
            <div class="bg-white rounded-2xl shadow-lg p-8 md:p-12">
                <header class="mb-12">
                    <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-[#1d1d1f] mb-4 leading-tight">{post.data.title}</h1>
                    <div class="flex flex-wrap items-center gap-4 text-sm text-slate-500">
                        <time>
                            {new Date(post.data.pubDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
                        </time>
                        {post.data.author && (
                            <span>by {post.data.author}</span>
                        )}
                    </div>
                    {post.data.tags && (
                        <div class="flex flex-wrap gap-2 mt-6">
                            {post.data.tags.map((tag: string) => (
                                <span class="px-3 py-1 bg-slate-100 text-slate-600 text-xs font-medium rounded-full">{tag}</span>
                            ))}
                        </div>
                    )}
                </header>
                
                <div class="prose prose-lg prose-slate max-w-none">
                    <Content />
                </div>

                <!-- Author Profile Section -->
                {post.data.author && (
                    <div class="mt-16 pt-8 border-t border-slate-200">
                        <div class="flex items-start gap-6">
                            <div class="flex-shrink-0">
                                <div class="w-20 h-20 rounded-full bg-gradient-to-br from-[#0071e3] to-[#5e5ce6] flex items-center justify-center text-white text-2xl font-bold shadow-lg" role="img" aria-label={`${post.data.author} avatar`}>
                                    {post.data.author.split(' ').filter((n: string) => n.length > 0).map((n: string) => n[0]).join('').slice(0, 2).toUpperCase()}
                                </div>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-xl font-bold text-[#1d1d1f] mb-2">About the Author</h3>
                                <p class="text-lg font-semibold text-slate-700 mb-3">{post.data.author}</p>
                                <p class="text-slate-600 leading-relaxed mb-4">
                                    Tech Executive & Community Leader. Passionate about building great products, leading teams, and sharing knowledge. 
                                    President of Thai Programmer Association.
                                </p>
                                <div class="flex gap-4">
                                    <a href="https://linkedin.com/in/savepong" target="_blank" rel="noopener noreferrer" 
                                       class="inline-flex items-center gap-2 text-sm text-[#0071e3] hover:text-[#0077ed] transition-colors font-medium">
                                        <i class="fab fa-linkedin" aria-hidden="true"></i>
                                        LinkedIn
                                    </a>
                                    <a href="https://github.com/savepong" target="_blank" rel="noopener noreferrer"
                                       class="inline-flex items-center gap-2 text-sm text-[#0071e3] hover:text-[#0077ed] transition-colors font-medium">
                                        <i class="fab fa-github" aria-hidden="true"></i>
                                        GitHub
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        </div>
    </article>
</Layout>

<style is:global>
    .prose {
        color: #334155;
        line-height: 1.8;
    }
    .prose h2 {
        color: #1d1d1f;
        font-weight: 700;
        margin-top: 2em;
        margin-bottom: 1em;
    }
    .prose h3 {
        color: #1d1d1f;
        font-weight: 600;
        margin-top: 1.5em;
        margin-bottom: 0.75em;
    }
    .prose p {
        margin-bottom: 1.5em;
    }
    .prose a {
        color: #0071e3;
        text-decoration: none;
    }
    .prose a:hover {
        text-decoration: underline;
    }
    .prose code {
        background: #f1f5f9;
        padding: 0.2em 0.4em;
        border-radius: 0.25em;
        font-size: 0.9em;
    }
    .prose pre {
        background: #1e293b;
        padding: 1.5em;
        border-radius: 1em;
        overflow-x: auto;
    }
    .prose pre code {
        background: transparent;
        padding: 0;
        color: #e2e8f0;
    }
    .prose blockquote {
        border-left: 4px solid #0071e3;
        padding-left: 1em;
        color: #64748b;
        font-style: italic;
    }
    .prose ul, .prose ol {
        padding-left: 1.5em;
    }
    .prose li {
        margin-bottom: 0.5em;
    }
    .prose img {
        border-radius: 1em;
        margin: 2em 0;
    }
</style>
